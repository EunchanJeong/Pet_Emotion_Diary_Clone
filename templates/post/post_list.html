{% comment %} <form method="GET" action="{% url 'post:index' %}">
    <label for="category">Category:</label>
    <select name="category" id="category">
      <option value="">All</option>
      <option value="free_type">Free</option>
      <option value="worry_type">Worry</option>
      <option value="brag_type">Brag</option>
    </select>
  
    <label for="kind">Kind:</label>
    <select name="kind" id="kind">
      <option value="">All</option>
      <option value="Dog">Dog</option>
      <option value="Cat">Cat</option>
    </select>
  
    <button type="submit">Filter</button>
  </form> {% endcomment %}
  <form method="GET" action="{% url 'post:index' %}">
    <label for="category">Category:</label>
    <select name="category" id="category">
        <option value="" {% if request.GET.category == "" %}selected{% endif %}>All</option>
        <option value="free_type" {% if request.GET.category == "free_type" %}selected{% endif %}>Free</option>
        <option value="worry_type" {% if request.GET.category == "worry_type" %}selected{% endif %}>Worry</option>
        <option value="brag_type" {% if request.GET.category == "brag_type" %}selected{% endif %}>Brag</option>
    </select>

    <label for="kind">Kind:</label>
    <select name="kind" id="kind">
        <option value="" {% if request.GET.kind == "" %}selected{% endif %}>All</option>
        <option value="Dog" {% if request.GET.kind == "Dog" %}selected{% endif %}>Dog</option>
        <option value="Cat" {% if request.GET.kind == "Cat" %}selected{% endif %}>Cat</option>
    </select>

    <button type="submit">Filter</button>
</form>

  <div class="container my-3">
    <div class="row my-3">
      {% comment %} <div class="col-6">
          <a href="{% url 'pybo:question_create' %}" class="btn btn-primary">질문 등록하기</a>
      </div> {% endcomment %}
      <div class="col-6">
          <div class="input-group">
              <input type="text" id="search_kw" class="form-control" value="{{ kw|default_if_none:'' }}">
              <div class="input-group-append">
                  <button class="btn btn-outline-secondary" type="button" id="btn_search">찾기</button>
              </div>
          </div>
      </div>
  </div>
    {% if post_list %}
      <ul>
      {% for post in post_list %}
          <li><a href="{% url 'post:detail' post.id %}">{{ post.title }} : {{post.user.nick_name}}</a></li>
      {% endfor %}
      </ul>
  {% else %}
      <p>게시글이 없습니다.</p>
  {% endif %}
    

  <!-- 페이징처리 시작 -->
  <ul class="pagination justify-content-center">
    <!-- 이전페이지 -->
    {% if post_list.has_previous %}
        <li class="page-item">
          <a class="page-link" data-page="{{ post_list.previous_page_number }}"
          href="?page={{ post_list.previous_page_number }}&category={{ request.GET.category }}&kind={{ request.GET.kind }}"
          onclick="handleClick(event, {{ post_list.previous_page_number }})">이전</a>
        </li>
    {% else %}
        <li class="page-item disabled">
            <a class="page-link" tabindex="-1" aria-disabled="true" href="#">이전</a>
        </li>
    {% endif %}
    <!-- 페이지리스트 -->
    {% for page_number in post_list.paginator.page_range %}
        {% if page_number == post_list.number %}
            <li class="page-item active" aria-current="page">
              <a class="page-link" data-page="{{ page_number }}"
              href="?page={{ page_number }}&category={{ request.GET.category }}&kind={{ request.GET.kind }}"
              onclick="handleClick(event, {{ page_number }})">{{ page_number }}</a>
            </li>
        {% else %}
            <li class="page-item">
              <a class="page-link" data-page="{{ page_number }}"
              href="?page={{ page_number }}&category={{ request.GET.category }}&kind={{ request.GET.kind }}"
              onclick="handleClick(event, {{ page_number }})">{{ page_number }}</a>
            </li>
        {% endif %}
    {% endfor %}
    <!-- 다음페이지 -->
    {% if post_list.has_next %}
        <li class="page-item">
          <a class="page-link" data-page="{{ post_list.next_page_number }}"
          href="?page={{ post_list.next_page_number }}&category={{ request.GET.category }}&kind={{ request.GET.kind }}"
          onclick="handleClick(event, {{ post_list.next_page_number }})">다음</a>
        </li>
    {% else %}
        <li class="page-item disabled">
            <a class="page-link" tabindex="-1" aria-disabled="true" href="#">다음</a>
        </li>
    {% endif %}
  </ul>
  <!-- 페이징처리 끝 -->
</div>
{% comment %} <form id="searchForm" method="get" action="{% url 'post:index' %}">
  <input type="hidden" id="kw" name="kw" value="{{ kw|default_if_none:'' }}">
  <input type="hidden" id="page" name="page" value="{{ page }}">
</form> {% endcomment %}
<form id="searchForm" method="get" action="{% url 'post:index' %}">
  <input type="hidden" id="kw" name="kw" value="{{ kw|default_if_none:'' }}">
  <input type="hidden" id="page" name="page" value="{{ page }}">
  <input type="hidden" id="filter_category" name="category" value="{{ request.GET.category }}">
  <input type="hidden" id="filter_kind" name="kind" value="{{ request.GET.kind }}">
</form>



{% block script %}
<script type='text/javascript'>
{% comment %} const page_elements = document.getElementsByClassName("page-link");
Array.from(page_elements).forEach(function(element) {
    element.addEventListener('click', function() {
        document.getElementById('page').value = this.dataset.page;
        document.getElementById('searchForm').submit();
    });
});

const btn_search = document.getElementById("btn_search");
btn_search.addEventListener('click', function() {
    document.getElementById('kw').value = document.getElementById('search_kw').value;
    document.getElementById('page').value = 1;  // 검색버튼을 클릭할 경우 1페이지부터 조회한다.
    document.getElementById('searchForm').submit();
}); {% endcomment %}
function handleClick(event, pageNumber) {
  // 기본 동작 방지
  event.preventDefault();

  // 페이지 값이 1 이상인지 확인
  if (pageNumber < 1) {
    console.log('Invalid page number: ' + pageNumber);
    return;
  }

  // 페이지 값을 업데이트
  document.getElementById('page').value = pageNumber;

  // 필터링 값을 업데이트
  document.getElementById('filter_category').value = document.getElementById('category').value;
  document.getElementById('filter_kind').value = document.getElementById('kind').value;

  // 폼 제출
  document.getElementById('searchForm').submit();
}

const btn_search = document.getElementById("btn_search");
btn_search.addEventListener('click', function() {
  document.getElementById('kw').value = document.getElementById('search_kw').value;
  document.getElementById('page').value = 1;  // 검색 버튼을 클릭할 경우 1페이지부터 조회
  document.getElementById('searchForm').submit();
});
</script>

{% endblock %} 